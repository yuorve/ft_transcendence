{
  "version": 3,
  "sources": ["../../../dev/core/src/AudioV2/abstractAudio/mainAudioBus.ts", "../../../dev/core/src/AudioV2/webAudio/webAudioMainBus.ts"],
  "sourcesContent": ["import { AbstractAudioBus } from \"./abstractAudioBus\";\nimport type { AudioEngineV2 } from \"./audioEngineV2\";\nimport type { IAbstractAudioBusOptions } from \"./abstractAudioBus\";\n\n/**\n * Options for creating a main audio bus.\n */\nexport interface IMainAudioBusOptions extends IAbstractAudioBusOptions {}\n\n/**\n * Abstract class representing a main audio bus.\n *\n * Main audio buses are the last bus in the audio graph.\n *\n * Unlike {@link AudioBus} instances, `MainAudioBus` instances have no spatial audio and stereo output capabilities,\n * and they cannot be connected downstream to another audio bus. They only connect downstream to the audio engine's\n * main output.\n *\n * Main audio buses are created by the {@link CreateMainAudioBusAsync} function.\n */\nexport abstract class MainAudioBus extends AbstractAudioBus {\n    protected constructor(name: string, engine: AudioEngineV2) {\n        super(name, engine);\n    }\n}\n", "import type { Nullable } from \"../../types\";\nimport type { AbstractAudioNode } from \"../abstractAudio/abstractAudioNode\";\nimport type { IMainAudioBusOptions } from \"../abstractAudio/mainAudioBus\";\nimport { MainAudioBus } from \"../abstractAudio/mainAudioBus\";\nimport { _WebAudioBaseSubGraph } from \"./subNodes/webAudioBaseSubGraph\";\nimport type { _WebAudioEngine } from \"./webAudioEngine\";\nimport type { IWebAudioInNode, IWebAudioSuperNode } from \"./webAudioNode\";\n\n/** @internal */\nexport class _WebAudioMainBus extends MainAudioBus implements IWebAudioSuperNode {\n    protected _subGraph: _WebAudioBaseSubGraph;\n\n    /** @internal */\n    public override readonly engine: _WebAudioEngine;\n\n    /** @internal */\n    public constructor(name: string, engine: _WebAudioEngine) {\n        super(name, engine);\n\n        this._subGraph = new _WebAudioMainBus._SubGraph(this);\n    }\n\n    /** @internal */\n    public async _init(options: Partial<IMainAudioBusOptions>): Promise<void> {\n        await this._subGraph.init(options);\n\n        if (this.engine.mainOut) {\n            if (!this._connect(this.engine.mainOut)) {\n                throw new Error(\"Connect failed\");\n            }\n        }\n\n        this.engine._addMainBus(this);\n    }\n\n    /** @internal */\n    public override dispose(): void {\n        super.dispose();\n\n        this.engine._removeMainBus(this);\n    }\n\n    /** @internal */\n    public get _inNode() {\n        return this._subGraph._inNode;\n    }\n\n    /** @internal */\n    public get _outNode() {\n        return this._subGraph._outNode;\n    }\n\n    protected override _connect(node: IWebAudioInNode): boolean {\n        const connected = super._connect(node);\n\n        if (!connected) {\n            return false;\n        }\n\n        if (node._inNode) {\n            this._outNode?.connect(node._inNode);\n        }\n\n        return true;\n    }\n\n    protected override _disconnect(node: IWebAudioInNode): boolean {\n        const disconnected = super._disconnect(node);\n\n        if (!disconnected) {\n            return false;\n        }\n\n        if (node._inNode) {\n            this._outNode?.disconnect(node._inNode);\n        }\n\n        return true;\n    }\n\n    /** @internal */\n    public getClassName(): string {\n        return \"_WebAudioMainBus\";\n    }\n\n    private static _SubGraph = class extends _WebAudioBaseSubGraph {\n        protected override _owner: _WebAudioMainBus;\n\n        protected get _downstreamNodes(): Nullable<Set<AbstractAudioNode>> {\n            return this._owner._downstreamNodes ?? null;\n        }\n    };\n}\n"],
  "mappings": ";;;;;;;;AAoBM,IAAgB,eAAhB,cAAqC,iBAAgB;EACvD,YAAsB,MAAc,QAAqB;AACrD,UAAM,MAAM,MAAM;EACtB;;;;ACdE,IAAO,mBAAP,MAAO,0BAAyB,aAAY;;EAO9C,YAAmB,MAAc,QAAuB;AACpD,UAAM,MAAM,MAAM;AAElB,SAAK,YAAY,IAAI,kBAAiB,UAAU,IAAI;EACxD;;EAGO,MAAM,MAAM,SAAsC;AACrD,UAAM,KAAK,UAAU,KAAK,OAAO;AAEjC,QAAI,KAAK,OAAO,SAAS;AACrB,UAAI,CAAC,KAAK,SAAS,KAAK,OAAO,OAAO,GAAG;AACrC,cAAM,IAAI,MAAM,gBAAgB;MACpC;IACJ;AAEA,SAAK,OAAO,YAAY,IAAI;EAChC;;EAGgB,UAAO;AACnB,UAAM,QAAO;AAEb,SAAK,OAAO,eAAe,IAAI;EACnC;;EAGA,IAAW,UAAO;AACd,WAAO,KAAK,UAAU;EAC1B;;EAGA,IAAW,WAAQ;AACf,WAAO,KAAK,UAAU;EAC1B;EAEmB,SAAS,MAAqB;AAjDrD;AAkDQ,UAAM,YAAY,MAAM,SAAS,IAAI;AAErC,QAAI,CAAC,WAAW;AACZ,aAAO;IACX;AAEA,QAAI,KAAK,SAAS;AACd,iBAAK,aAAL,mBAAe,QAAQ,KAAK;IAChC;AAEA,WAAO;EACX;EAEmB,YAAY,MAAqB;AA/DxD;AAgEQ,UAAM,eAAe,MAAM,YAAY,IAAI;AAE3C,QAAI,CAAC,cAAc;AACf,aAAO;IACX;AAEA,QAAI,KAAK,SAAS;AACd,iBAAK,aAAL,mBAAe,WAAW,KAAK;IACnC;AAEA,WAAO;EACX;;EAGO,eAAY;AACf,WAAO;EACX;;AAEe,iBAAA,YAAY,cAAc,sBAAqB;EAG1D,IAAc,mBAAgB;AAC1B,WAAO,KAAK,OAAO,oBAAoB;EAC3C;;",
  "names": []
}
