{"version":3,"file":"loadingScreen.js","sourceRoot":"","sources":["../../../../dev/core/src/Loading/loadingScreen.ts"],"names":[],"mappings":"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","sourcesContent":["import type { Nullable } from \"../types\";\r\nimport { AbstractEngine } from \"../Engines/abstractEngine\";\r\nimport { EngineStore } from \"../Engines/engineStore\";\r\nimport type { Observer } from \"../Misc/observable\";\r\n/**\r\n * Interface used to present a loading screen while loading a scene\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/scene/customLoadingScreen\r\n */\r\nexport interface ILoadingScreen {\r\n    /**\r\n     * Function called to display the loading screen\r\n     */\r\n    displayLoadingUI: () => void;\r\n    /**\r\n     * Function called to hide the loading screen\r\n     */\r\n    hideLoadingUI: () => void;\r\n    /**\r\n     * Gets or sets the color to use for the background\r\n     */\r\n    loadingUIBackgroundColor: string;\r\n    /**\r\n     * Gets or sets the text to display while loading\r\n     */\r\n    loadingUIText: string;\r\n}\r\n\r\n/**\r\n * Class used for the default loading screen\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/scene/customLoadingScreen\r\n */\r\nexport class DefaultLoadingScreen implements ILoadingScreen {\r\n    private _engine: Nullable<AbstractEngine>;\r\n    private _resizeObserver: Nullable<Observer<AbstractEngine>>;\r\n    private _isLoading: boolean;\r\n    /**\r\n     * Maps a loading `HTMLDivElement` to a tuple containing the associated `HTMLCanvasElement`\r\n     * and its `DOMRect` (or `null` if not yet available).\r\n     */\r\n    private _loadingDivToRenderingCanvasMap: Map<HTMLDivElement, [HTMLCanvasElement, DOMRect | null]> = new Map();\r\n    private _loadingTextDiv: Nullable<HTMLDivElement>;\r\n    private _style: Nullable<HTMLStyleElement>;\r\n\r\n    /** Gets or sets the logo url to use for the default loading screen */\r\n    public static DefaultLogoUrl = \"\";\r\n\r\n    /** Gets or sets the spinner url to use for the default loading screen */\r\n    public static DefaultSpinnerUrl = \"\";\r\n\r\n    /**\r\n     * Creates a new default loading screen\r\n     * @param _renderingCanvas defines the canvas used to render the scene\r\n     * @param _loadingText defines the default text to display\r\n     * @param _loadingDivBackgroundColor defines the default background color\r\n     */\r\n    constructor(\r\n        private _renderingCanvas: HTMLCanvasElement,\r\n        private _loadingText = \"\",\r\n        private _loadingDivBackgroundColor = \"black\"\r\n    ) {}\r\n\r\n    /**\r\n     * Function called to display the loading screen\r\n     */\r\n    public displayLoadingUI(): void {\r\n        if (this._isLoading) {\r\n            // Do not add a loading screen if it is already loading\r\n            return;\r\n        }\r\n\r\n        this._isLoading = true;\r\n        // get current engine by rendering canvas\r\n        this._engine = EngineStore.Instances.find((engine) => engine.getRenderingCanvas() === this._renderingCanvas) as AbstractEngine;\r\n\r\n        const loadingDiv = document.createElement(\"div\");\r\n\r\n        loadingDiv.id = \"babylonjsLoadingDiv\";\r\n        loadingDiv.style.opacity = \"0\";\r\n        loadingDiv.style.transition = \"opacity 1.5s ease\";\r\n        loadingDiv.style.pointerEvents = \"none\";\r\n        loadingDiv.style.display = \"grid\";\r\n        loadingDiv.style.gridTemplateRows = \"100%\";\r\n        loadingDiv.style.gridTemplateColumns = \"100%\";\r\n        loadingDiv.style.justifyItems = \"center\";\r\n        loadingDiv.style.alignItems = \"center\";\r\n\r\n        // Loading text\r\n        this._loadingTextDiv = document.createElement(\"div\");\r\n        this._loadingTextDiv.style.position = \"absolute\";\r\n        this._loadingTextDiv.style.left = \"0\";\r\n        this._loadingTextDiv.style.top = \"50%\";\r\n        this._loadingTextDiv.style.marginTop = \"80px\";\r\n        this._loadingTextDiv.style.width = \"100%\";\r\n        this._loadingTextDiv.style.height = \"20px\";\r\n        this._loadingTextDiv.style.fontFamily = \"Arial\";\r\n        this._loadingTextDiv.style.fontSize = \"14px\";\r\n        this._loadingTextDiv.style.color = \"white\";\r\n        this._loadingTextDiv.style.textAlign = \"center\";\r\n        this._loadingTextDiv.style.zIndex = \"1\";\r\n        this._loadingTextDiv.innerHTML = \"Loading\";\r\n\r\n        loadingDiv.appendChild(this._loadingTextDiv);\r\n\r\n        //set the predefined text\r\n        this._loadingTextDiv.innerHTML = this._loadingText;\r\n\r\n        // Generating keyframes\r\n        this._style = document.createElement(\"style\");\r\n        this._style.type = \"text/css\";\r\n        const keyFrames = `@-webkit-keyframes spin1 {\\\r\n                            0% { -webkit-transform: rotate(0deg);}\r\n                            100% { -webkit-transform: rotate(360deg);}\r\n                        }\\\r\n                        @keyframes spin1 {\\\r\n                            0% { transform: rotate(0deg);}\r\n                            100% { transform: rotate(360deg);}\r\n                        }`;\r\n        this._style.innerHTML = keyFrames;\r\n        document.getElementsByTagName(\"head\")[0].appendChild(this._style);\r\n\r\n        const svgSupport = !!window.SVGSVGElement;\r\n        // Loading img\r\n        const imgBack = new Image();\r\n        if (!DefaultLoadingScreen.DefaultLogoUrl) {\r\n            imgBack.src = !svgSupport\r\n                ? \"https://cdn.babylonjs.com/Assets/babylonLogo.png\"\r\n                : `data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxODAuMTcgMjA4LjA0Ij48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6I2ZmZjt9LmNscy0ye2ZpbGw6I2UwNjg0Yjt9LmNscy0ze2ZpbGw6I2JiNDY0Yjt9LmNscy00e2ZpbGw6I2UwZGVkODt9LmNscy01e2ZpbGw6I2Q1ZDJjYTt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPkJhYnlsb25Mb2dvPC90aXRsZT48ZyBpZD0iTGF5ZXJfMiIgZGF0YS1uYW1lPSJMYXllciAyIj48ZyBpZD0iUGFnZV9FbGVtZW50cyIgZGF0YS1uYW1lPSJQYWdlIEVsZW1lbnRzIj48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik05MC4wOSwwLDAsNTJWMTU2bDkwLjA5LDUyLDkwLjA4LTUyVjUyWiIvPjxwb2x5Z29uIGNsYXNzPSJjbHMtMiIgcG9pbnRzPSIxODAuMTcgNTIuMDEgMTUxLjk3IDM1LjczIDEyNC44NSA1MS4zOSAxNTMuMDUgNjcuNjcgMTgwLjE3IDUyLjAxIi8+PHBvbHlnb24gY2xhc3M9ImNscy0yIiBwb2ludHM9IjI3LjEyIDY3LjY3IDExNy4yMSAxNS42NiA5MC4wOCAwIDAgNTIuMDEgMjcuMTIgNjcuNjciLz48cG9seWdvbiBjbGFzcz0iY2xzLTIiIHBvaW50cz0iNjEuODkgMTIwLjMgOTAuMDggMTM2LjU4IDExOC4yOCAxMjAuMyA5MC4wOCAxMDQuMDIgNjEuODkgMTIwLjMiLz48cG9seWdvbiBjbGFzcz0iY2xzLTMiIHBvaW50cz0iMTUzLjA1IDY3LjY3IDE1My4wNSAxNDAuMzcgOTAuMDggMTc2LjcyIDI3LjEyIDE0MC4zNyAyNy4xMiA2Ny42NyAwIDUyLjAxIDAgMTU2LjAzIDkwLjA4IDIwOC4wNCAxODAuMTcgMTU2LjAzIDE4MC4xNyA1Mi4wMSAxNTMuMDUgNjcuNjciLz48cG9seWdvbiBjbGFzcz0iY2xzLTMiIHBvaW50cz0iOTAuMDggNzEuNDYgNjEuODkgODcuNzQgNjEuODkgMTIwLjMgOTAuMDggMTA0LjAyIDExOC4yOCAxMjAuMyAxMTguMjggODcuNzQgOTAuMDggNzEuNDYiLz48cG9seWdvbiBjbGFzcz0iY2xzLTQiIHBvaW50cz0iMTUzLjA1IDY3LjY3IDExOC4yOCA4Ny43NCAxMTguMjggMTIwLjMgOTAuMDggMTM2LjU4IDkwLjA4IDE3Ni43MiAxNTMuMDUgMTQwLjM3IDE1My4wNSA2Ny42NyIvPjxwb2x5Z29uIGNsYXNzPSJjbHMtNSIgcG9pbnRzPSIyNy4xMiA2Ny42NyA2MS44OSA4Ny43NCA2MS44OSAxMjAuMyA5MC4wOCAxMzYuNTggOTAuMDggMTc2LjcyIDI3LjEyIDE0MC4zNyAyNy4xMiA2Ny42NyIvPjwvZz48L2c+PC9zdmc+`;\r\n        } else {\r\n            imgBack.src = DefaultLoadingScreen.DefaultLogoUrl;\r\n        }\r\n\r\n        imgBack.style.width = \"150px\";\r\n        imgBack.style.gridColumn = \"1\";\r\n        imgBack.style.gridRow = \"1\";\r\n        imgBack.style.top = \"50%\";\r\n        imgBack.style.left = \"50%\";\r\n        imgBack.style.transform = \"translate(-50%, -50%)\";\r\n        imgBack.style.position = \"absolute\";\r\n\r\n        const imageSpinnerContainer = document.createElement(\"div\");\r\n        imageSpinnerContainer.style.width = \"300px\";\r\n        imageSpinnerContainer.style.gridColumn = \"1\";\r\n        imageSpinnerContainer.style.gridRow = \"1\";\r\n        imageSpinnerContainer.style.top = \"50%\";\r\n        imageSpinnerContainer.style.left = \"50%\";\r\n        imageSpinnerContainer.style.transform = \"translate(-50%, -50%)\";\r\n        imageSpinnerContainer.style.position = \"absolute\";\r\n\r\n        // Loading spinner\r\n        const imgSpinner = new Image();\r\n\r\n        if (!DefaultLoadingScreen.DefaultSpinnerUrl) {\r\n            imgSpinner.src = !svgSupport\r\n                ? \"https://cdn.babylonjs.com/Assets/loadingIcon.png\"\r\n                : `data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzOTIgMzkyIj48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6I2UwNjg0Yjt9LmNscy0ye2ZpbGw6bm9uZTt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPlNwaW5uZXJJY29uPC90aXRsZT48ZyBpZD0iTGF5ZXJfMiIgZGF0YS1uYW1lPSJMYXllciAyIj48ZyBpZD0iU3Bpbm5lciI+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNNDAuMjEsMTI2LjQzYzMuNy03LjMxLDcuNjctMTQuNDQsMTItMjEuMzJsMy4zNi01LjEsMy41Mi01YzEuMjMtMS42MywyLjQxLTMuMjksMy42NS00LjkxczIuNTMtMy4yMSwzLjgyLTQuNzlBMTg1LjIsMTg1LjIsMCwwLDEsODMuNCw2Ny40M2EyMDgsMjA4LDAsMCwxLDE5LTE1LjY2YzMuMzUtMi40MSw2Ljc0LTQuNzgsMTAuMjUtN3M3LjExLTQuMjgsMTAuNzUtNi4zMmM3LjI5LTQsMTQuNzMtOCwyMi41My0xMS40OSwzLjktMS43Miw3Ljg4LTMuMywxMi00LjY0YTEwNC4yMiwxMDQuMjIsMCwwLDEsMTIuNDQtMy4yMyw2Mi40NCw2Mi40NCwwLDAsMSwxMi43OC0xLjM5QTI1LjkyLDI1LjkyLDAsMCwxLDE5NiwyMS40NGE2LjU1LDYuNTUsMCwwLDEsMi4wNSw5LDYuNjYsNi42NiwwLDAsMS0xLjY0LDEuNzhsLS40MS4yOWEyMi4wNywyMi4wNywwLDAsMS01Ljc4LDMsMzAuNDIsMzAuNDIsMCwwLDEtNS42NywxLjYyLDM3LjgyLDM3LjgyLDAsMCwxLTUuNjkuNzFjLTEsMC0xLjkuMTgtMi44NS4yNmwtMi44NS4yNHEtNS43Mi41MS0xMS40OCwxLjFjLTMuODQuNC03LjcxLjgyLTExLjU4LDEuNGExMTIuMzQsMTEyLjM0LDAsMCwwLTIyLjk0LDUuNjFjLTMuNzIsMS4zNS03LjM0LDMtMTAuOTQsNC42NHMtNy4xNCwzLjUxLTEwLjYsNS41MUExNTEuNiwxNTEuNiwwLDAsMCw2OC41Niw4N0M2Ny4yMyw4OC40OCw2Niw5MCw2NC42NCw5MS41NnMtMi41MSwzLjE1LTMuNzUsNC43M2wtMy41NCw0LjljLTEuMTMsMS42Ni0yLjIzLDMuMzUtMy4zMyw1YTEyNywxMjcsMCwwLDAtMTAuOTMsMjEuNDksMS41OCwxLjU4LDAsMSwxLTMtMS4xNVM0MC4xOSwxMjYuNDcsNDAuMjEsMTI2LjQzWiIvPjxyZWN0IGNsYXNzPSJjbHMtMiIgd2lkdGg9IjM5MiIgaGVpZ2h0PSIzOTIiLz48L2c+PC9nPjwvc3ZnPg==`;\r\n        } else {\r\n            imgSpinner.src = DefaultLoadingScreen.DefaultSpinnerUrl;\r\n        }\r\n\r\n        imgSpinner.style.animation = \"spin1 0.75s infinite linear\";\r\n        imgSpinner.style.transformOrigin = \"50% 50%\";\r\n\r\n        if (!svgSupport) {\r\n            const logoSize = { w: 16, h: 18.5 };\r\n            const loadingSize = { w: 30, h: 30 };\r\n            // set styling correctly\r\n            imgBack.style.width = `${logoSize.w}vh`;\r\n            imgBack.style.height = `${logoSize.h}vh`;\r\n            imgBack.style.left = `calc(50% - ${logoSize.w / 2}vh)`;\r\n            imgBack.style.top = `calc(50% - ${logoSize.h / 2}vh)`;\r\n\r\n            imgSpinner.style.width = `${loadingSize.w}vh`;\r\n            imgSpinner.style.height = `${loadingSize.h}vh`;\r\n            imgSpinner.style.left = `calc(50% - ${loadingSize.w / 2}vh)`;\r\n            imgSpinner.style.top = `calc(50% - ${loadingSize.h / 2}vh)`;\r\n        }\r\n\r\n        imageSpinnerContainer.appendChild(imgSpinner);\r\n\r\n        loadingDiv.appendChild(imgBack);\r\n        loadingDiv.appendChild(imageSpinnerContainer);\r\n        loadingDiv.style.backgroundColor = this._loadingDivBackgroundColor;\r\n        loadingDiv.style.opacity = \"1\";\r\n\r\n        const canvases: Array<HTMLCanvasElement> = [];\r\n        const views = this._engine.views;\r\n        if (views?.length) {\r\n            for (const view of views) {\r\n                if (view.enabled) {\r\n                    canvases.push(view.target);\r\n                }\r\n            }\r\n        } else {\r\n            canvases.push(this._renderingCanvas);\r\n        }\r\n        canvases.forEach((canvas, index) => {\r\n            const clonedLoadingDiv = loadingDiv!.cloneNode(true) as HTMLDivElement;\r\n            clonedLoadingDiv.id += `-${index}`;\r\n            this._loadingDivToRenderingCanvasMap.set(clonedLoadingDiv, [canvas, null]);\r\n        });\r\n\r\n        this._resizeLoadingUI();\r\n\r\n        this._resizeObserver = this._engine.onResizeObservable.add(() => {\r\n            this._resizeLoadingUI();\r\n        });\r\n\r\n        this._loadingDivToRenderingCanvasMap.forEach((_, loadingDiv) => {\r\n            document.body.appendChild(loadingDiv);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Function called to hide the loading screen\r\n     */\r\n    public hideLoadingUI(): void {\r\n        if (!this._isLoading) {\r\n            return;\r\n        }\r\n\r\n        let completedTransitions = 0;\r\n\r\n        const onTransitionEnd = (event: TransitionEvent) => {\r\n            const loadingDiv = event.target as HTMLDivElement;\r\n            // ensure that ending transition event is generated by one of the current loadingDivs\r\n            const isTransitionEndOnLoadingDiv = this._loadingDivToRenderingCanvasMap.has(loadingDiv);\r\n\r\n            if (isTransitionEndOnLoadingDiv) {\r\n                completedTransitions++;\r\n                loadingDiv.remove();\r\n\r\n                const allTransitionsCompleted = completedTransitions === this._loadingDivToRenderingCanvasMap.size;\r\n                if (allTransitionsCompleted) {\r\n                    if (this._loadingTextDiv) {\r\n                        this._loadingTextDiv.remove();\r\n                        this._loadingTextDiv = null;\r\n                    }\r\n                    if (this._style) {\r\n                        this._style.remove();\r\n                        this._style = null;\r\n                    }\r\n\r\n                    window.removeEventListener(\"transitionend\", onTransitionEnd);\r\n                    this._engine!.onResizeObservable.remove(this._resizeObserver);\r\n                    this._loadingDivToRenderingCanvasMap.clear();\r\n                    this._engine = null;\r\n                    this._isLoading = false;\r\n                }\r\n            }\r\n        };\r\n\r\n        this._loadingDivToRenderingCanvasMap.forEach((_, loadingDiv) => {\r\n            loadingDiv.style.opacity = \"0\";\r\n        });\r\n\r\n        window.addEventListener(\"transitionend\", onTransitionEnd);\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the text to display while loading\r\n     */\r\n    public set loadingUIText(text: string) {\r\n        this._loadingText = text;\r\n\r\n        if (this._loadingTextDiv) {\r\n            this._loadingDivToRenderingCanvasMap.forEach((_, loadingDiv) => {\r\n                // set loadingTextDiv of current loadingDiv\r\n                loadingDiv.children[0].innerHTML = this._loadingText;\r\n            });\r\n        }\r\n    }\r\n\r\n    public get loadingUIText(): string {\r\n        return this._loadingText;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the color to use for the background\r\n     */\r\n    public get loadingUIBackgroundColor(): string {\r\n        return this._loadingDivBackgroundColor;\r\n    }\r\n\r\n    public set loadingUIBackgroundColor(color: string) {\r\n        this._loadingDivBackgroundColor = color;\r\n\r\n        if (!this._isLoading) {\r\n            return;\r\n        }\r\n\r\n        this._loadingDivToRenderingCanvasMap.forEach((_, loadingDiv) => {\r\n            loadingDiv.style.backgroundColor = this._loadingDivBackgroundColor;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Checks if the layout of the canvas has changed by comparing the current layout\r\n     * rectangle with the previous one.\r\n     *\r\n     * This function compares of the two `DOMRect` objects to determine if any of the layout dimensions have changed.\r\n     * If the layout has changed or if there is no previous layout (i.e., `previousCanvasRect` is `null`),\r\n     * it returns `true`. Otherwise, it returns `false`.\r\n     *\r\n     * @param previousCanvasRect defines the previously recorded `DOMRect` of the canvas, or `null` if no previous state exists.\r\n     * @param currentCanvasRect defines the current `DOMRect` of the canvas to compare against the previous layout.\r\n     * @returns `true` if the layout has changed, otherwise `false`.\r\n     */\r\n    private _isCanvasLayoutChanged(previousCanvasRect: DOMRect | null, currentCanvasRect: DOMRect) {\r\n        return (\r\n            !previousCanvasRect ||\r\n            previousCanvasRect.left !== currentCanvasRect.left ||\r\n            previousCanvasRect.top !== currentCanvasRect.top ||\r\n            previousCanvasRect.right !== currentCanvasRect.right ||\r\n            previousCanvasRect.bottom !== currentCanvasRect.bottom ||\r\n            previousCanvasRect.width !== currentCanvasRect.width ||\r\n            previousCanvasRect.height !== currentCanvasRect.height ||\r\n            previousCanvasRect.x !== currentCanvasRect.x ||\r\n            previousCanvasRect.y !== currentCanvasRect.y\r\n        );\r\n    }\r\n\r\n    // Resize\r\n    private _resizeLoadingUI = () => {\r\n        if (!this._isLoading) {\r\n            return;\r\n        }\r\n\r\n        this._loadingDivToRenderingCanvasMap.forEach(([canvas, previousCanvasRect], loadingDiv) => {\r\n            const currentCanvasRect = canvas.getBoundingClientRect();\r\n            if (this._isCanvasLayoutChanged(previousCanvasRect, currentCanvasRect)) {\r\n                const canvasPositioning = window.getComputedStyle(canvas).position;\r\n\r\n                loadingDiv.style.position = canvasPositioning === \"fixed\" ? \"fixed\" : \"absolute\";\r\n                loadingDiv.style.left = currentCanvasRect.left + window.scrollX + \"px\";\r\n                loadingDiv.style.top = currentCanvasRect.top + window.scrollY + \"px\";\r\n                loadingDiv.style.width = currentCanvasRect.width + \"px\";\r\n                loadingDiv.style.height = currentCanvasRect.height + \"px\";\r\n\r\n                this._loadingDivToRenderingCanvasMap.set(loadingDiv, [canvas, currentCanvasRect]);\r\n            }\r\n        });\r\n    };\r\n}\r\n\r\nAbstractEngine.DefaultLoadingScreenFactory = (canvas: HTMLCanvasElement) => {\r\n    return new DefaultLoadingScreen(canvas);\r\n};\r\n"]}